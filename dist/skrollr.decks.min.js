/*!
 * skrollr-decks 1.1.0
 * Fullpage presentation decks with scrolling
 * https://github.com/TrySound/skrollr-decks
 * 
 * Released under the MIT license
 * Copyright (c) 2016, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(t){"use strict";window.skrollr?window.skrollr.decks=t(window,document,window.skrollr):console.error("`skrollr` not found")}(function(t,e,n){"use strict";function r(t,e){(t=t.toLowerCase())in b&&"function"==typeof e&&b[t].unshift(e)}function o(t,e){var n,r=b[t];for(n=r.length-1;n>-1;n--)r[n].apply({},e)}function a(i){if(m)return!1;m=!0;var a,l,s,v=t.setTimeout,b=t.clearTimeout;s=k=h({},p,i,g(e.body)),a=n.init({forceHeight:!1,easing:s.customEasing}),y=c(s.decks,A),w=f(A),d(),e.body.appendChild(w),a.refresh(w.children),r("change",function(e){var n=location.href.split("#")[0]+"#"+e.id;s.history&&(history.pushState?history.pushState(null,null,n):t.location.hash=n)}),a.on("render",function(t){var e=this,n=u.call(e,t);b(l),void 0!==n&&s.autoscroll&&(l=v(function(){e.animateTo(n,s)},s.delay)),o("render",[t])})}function l(){if(!m)return!1;m=!1;var t=n.get(),r=e.getElementById("skrollr-decks-navlist");for(deck,i,r.parentElement.removeChild(r),i=A.length-1;i>-1;i--)deck=A[i],deck.style.height="auto";k=void 0,v=void 0,y={},A=[],r=void 0,b={render:[],change:[]},t&&t.destroy()}function s(t,e){var r,o,i,a=y[t],l=n.get();return!(!l||(l.stopAnimateTo(),a||(o=w.getElementsByClassName("skrollable-between"),1===o.length&&(i=Number(o[0].getAttribute("data-skrollr-decks-index")),a=A["up"===t?i-1:"down"===t?i+1:-1]),2===o.length&&(o=o["up"===t?0:"down"===t?1:-1],a=o?y[o.getAttribute("data-anchor-target")]:null)),!a))&&(r=l.relativeToAbsolute(a,"top","top")+1,e?l.setScrollTop(r,!0):l.animateTo(r,k),!0)}function d(){if(m){var e,r,o,i=t.innerHeight+2;for(o=A.length-1;o>-1;o--)e=A[o],e.style.height="auto",r=e.offsetHeight,e.style.height=(r<i?i:r)+"px";n.get().refresh(A)}}function u(e){if(m){var r,i,a,l,s,d,u=n.get(),c=w.getElementsByClassName("skrollable-between"),f=e.curTop,h=t.innerHeight,g=h*k.offset/100;return 1===c.length&&(r=y[c[0].getAttribute("data-anchor-target")],v!==r&&o("change",[r]),v=r),2===c.length?(i=y[c[0].getAttribute("data-anchor-target")],a=y[c[1].getAttribute("data-anchor-target")],s=u.relativeToAbsolute(i,"top","bottom"),l=u.relativeToAbsolute(a,"top","top"),"up"===e.direction&&s-g>f||l+g>f+h?(r=i,d=s-h-1):(r=a,d=l+1),v!==r&&o("change",[r]),v=r,d):void 0}}function c(t,n){var r,o,i={};+new Date;if("string"==typeof t)for(t=e.querySelectorAll(t),o=t.length-1;o>-1;o--)r=t[o],n.unshift(r),r.id=r.id?r.id:"skroll-deck-id-"+o,i["#"+r.id]=r;return i}function f(t){var n,r,o,i=e.createElement("ul"),a=e.createElement("li");for(i.style.display="none",i.setAttribute("id","skrollr-decks-navlist"),a.setAttribute("data-top-bottom",""),a.setAttribute("data-bottom-top",""),n=0,r=t.length;n<r;n++)o=a.cloneNode(),o.setAttribute("data-skrollr-decks-index",n),o.setAttribute("data-anchor-target","#"+t[n].id),i.appendChild(o);return i}function h(){var t,e,n,r,o=arguments[0]||{};for(t=1,e=arguments.length;t<e;t++)if(n=arguments[t],null!=n)for(r in n)n.hasOwnProperty(r)&&void 0!==n[r]&&(o[r]=n[r]);return o}function g(t){var e,n,r,o=t.attributes,i="data-skrollr-decks-",a={};for(e=o.length;e--;)n=o[e].name,r=o[e].value,0===n.indexOf(i)&&(a[n.substring(i.length)]="true"===r||"false"!==r&&(isNaN(r)?r:Number(r)));return a}var k,v,p={decks:".skrollr-deck",offset:10,duration:600,easing:"quadratic",delay:500,autoscroll:!0,history:!1,customEasing:{}},b={render:[],change:[]},m=!1,y={},A=[],w=e.createElement("ul");return n.addEvent(e,"keydown",function(t){var e=n.get(),r=[38,40,33,34,36,35];r.indexOf(t.keyCode)>-1&&e&&e.isAnimatingTo()&&e.stopAnimateTo()}),n.addEvent(e,"DOMContentLoaded",function(){e.querySelector("body.skrollr-decks-init")&&a()}),n.addEvent(t,"load resize",function(){d({}),v?s("#"+v.id,!0):u({})}),{init:a,destroy:l,animateTo:s,refresh:d,on:r}});