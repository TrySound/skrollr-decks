/*!
 * skrollr-decks 0.2.1
 * Fullpage presentation decks with scrolling
 * https://github.com/TrySound/skrollr-decks
 * 
 * Released under the MIT license
 * Copyright (c) 2015, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(t){"use strict";window.skrollr?window.skrollr.decks=t(window,document,window.skrollr):console.error("`skrollr` not found")}(function(t,e,s){"use strict";function i(t,e){return new RegExp(" "+e+" ").test(" "+t.className+" ")}function n(t,e){t&&!i(t,e)&&(t.className+=(t.className?" ":"")+e)}function r(t,e){t&&i(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}function a(t){var e,i=s.get(),n=t.deckDelay,r=this.updateSegment.bind(this);this._settings=t,this.getSegments(t.segments),this._segments.length>0?(this.resizeSegments(),this.getNav(t.nav),this.listenAnchors(),i.refresh(),i.on("render",function(t){l(e),e=o(function(){r("up"===t.direction)},n)})):this.invalid=!0}var o=t.setTimeout,l=t.clearTimeout;a.prototype={setActive:function(t,e){var i,a=this._items[t.getAttribute("data-skrollr-decks-index")],o=s.get();i=o.relativeToAbsolute(t,"top","top"),o.animateTo(i+1,{duration:e}),"deck"!==this._activeDeck&&(r(this._activeItem,"skrollr-decks-achor-active"),r(this._activeDeck,"skrollr-deck-active"),n(a,"skrollr-decks-achor-active"),n(t,"skrollr-deck-active"),this._activeItem=a,this._activeDeck=t)},getSegments:function(t){var s,i,n,r,a=[];for("string"==typeof t?s=e.querySelectorAll(t):t.tagName?s=[t]:t.length&&(s=t),n=0,r=s.length;r>n;n++)i=s[n],i.tagName&&(i.id||(i.id="skrollr-deck-"+n),a.push(i));return this._segments=a,a},resizeSegments:function(){function e(){var t,e=i.innerHeight+2+"px";for(t=s.length;t--;)s[t].style.minHeight=e}var s=this._segments,i=t;e(),t.addEventListener("resize",e,!1)},updateSegment:function(e){{var i,n,r;s.get()}i=this._nav.getElementsByClassName("skrollable-between"),n=i[e?0:i.length-1],r=this._segments[n.getAttribute("data-skrollr-decks-index")],(i.length>1||t.innerHeight+2===r.clientHeight)&&this.setActive(r,this._settings.deckDuration)},getNav:function(t){{var s,i;this._segments}return"string"==typeof t?s=e.querySelector(t):t.tagName?s=t:t.length&&t[0].tagName&&(s=t[0]),this._items=[],s?"UL"===s.tagName?(i=s,this.appendLinks(i)):(i=s.getElementsByTagName("ul")[0],i?this.appendLinks(i):(i=this.appendLinks(),s.appendChild(i))):(i=this.appendLinks(),i.className="skrollr-decks-nav",e.body.insertBefore(i,e.body.firstChild)),this._nav=i,i},appendLinks:function(t){var s,i,n,r,a,o=this._segments;for(t?i=t.getElementsByTagName("li"):(t=e.createElement("ul"),i=[]),r=0,a=o.length;a>r;r++)n="#"+o[r].id,s=i[r],s||(s=e.createElement("li"),t.appendChild(s)),o[r].setAttribute("data-skrollr-decks-index",r),s.setAttribute("data-skrollr-decks-index",r),s.setAttribute("data-anchor-target",n),s.innerHTML='<a href="'+n+'">'+s.innerHTML+"</a>",s.hasAttribute("data-top-bottom")||s.setAttribute("data-top-bottom",""),s.hasAttribute("data-bottom-top")||s.setAttribute("data-bottom-top",""),this._items.push(s);return t},listenAnchors:function(){var t=this;t._nav.addEventListener("click",function(e){var s,i,n=e.target,r=n.parentNode;"A"===n.tagName&&r.hasAttribute("data-skrollr-decks-index")&&(s=r.getAttribute("data-skrollr-decks-index"),i=t._segments[s],t.setActive(i,t._settings.gotoDuration)),e.preventDefault()},!1)}};var c={init:function(t){var e,i={segments:".skrollr-deck",nav:".skrollr-decks-nav",gotoDuration:600,deckDuration:300,deckDelay:200,autoScroll:!0},n={};t="object"==typeof t?t:{};for(e in i)i.hasOwnProperty(e)&&(n[e]=t[e]||i[e]);s.init({forceHeight:!1});this._decks||(this._decks=new a(n),this._decks.invalid&&(this._decks=void 0))}};return e.addEventListener("DOMContentLoaded",function(){var t=this.querySelector(".skrollr-decks-init");t&&c.init()},!1),c});